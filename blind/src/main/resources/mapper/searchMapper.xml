<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ksinfo.blind.search.mapper.SearchMapper">


<select id="getSearchCompany" resultType="com.ksinfo.blind.search.dto.CompanyDto"> 
    SELECT * FROM blind.company_mgt
    where company_name= #{searchKeyword};  
</select> 

<select id="getPostCount" resultType="com.ksinfo.blind.search.dto.CompanyDto"> 
    SELECT * FROM blind.company_mgt
    where company_name= #{searchKeyword};  
	groupby
</select>


<select id="getCompanyReviews" resultType="com.ksinfo.blind.search.dto.CompanyReviewDto"> 
	SELECT * FROM blind.company_review_mgt
	INNER JOIN blind.company_mgt
	ON blind.company_review_mgt.company_id = blind.company_mgt.company_id;	
</select>

<select id="getSearchPosts" resultType="com.ksinfo.blind.search.dto.PostDto"> 
    SELECT * FROM blind.post_mgt
    where post_title like '%'|| #{searchKeyword} ||'%' ;  
</select><!-- orderby 실시(추천순,작성일최신순) recommandCount / createDate를 조인하여실시.-->


<select id="getViewCountOfPosts" resultType="com.ksinfo.blind.search.dto.PostCountInfDto"> 
    <!-- SELECT blind.post_count_inf.post_count FROM blind.blind.post_count_inf -->
    SELECT * FROM blind.post_count_inf
    where #{postId} = blind.post_count_inf.post_id;
</select>
	

<select id="getReplysOfPosts" resultType="com.ksinfo.blind.search.dto.ReplyDto"> 
    SELECT * FROM blind.reply_mgt
    where  #{postId} = blind.reply_mgt.post_id;
</select>	
	
	
<select id="getRecommendCountOfPosts" resultType="int"> 
    SELECT count(post_id) FROM blind.post_recommend_inf
    where  #{postId} = blind.post_recommend_inf.post_id;
</select>		
	
	
<select id="getReplyCountsOfPosts" resultType="int"> 
    SELECT count(post_id) FROM blind.reply_mgt
    where  #{postId} = blind.reply_mgt.post_id;
</select>	
	
<select id="getWriterDataOfPosts" resultType="com.ksinfo.blind.search.dto.UserDto"> 
    SELECT * FROM blind.user_mgt
    where  #{userId} = blind.user_mgt.user_id;
</select>		
	
<select id="getWriterCompany" resultType="String"> 
    SELECT company_name FROM blind.company_mgt
    where  #{companyId} = blind.company_mgt.company_id;
</select>		

<select id="getJobGroupNameOfCompanyReviewer" resultType="String"> 
    SELECT job_group_name FROM blind.job_group_mst
    where cast(#{jobGroupCode} as char)  = blind.job_group_mst.job_group_code;
</select>		
	 
<select id="getBoardTopicName" resultType="com.ksinfo.blind.search.dto.BoardDto"> 
    SELECT * FROM blind.board_mgt
    where #{boardId} = blind.board_mgt.board_id;
</select>	

<select id="getBoardTopicCount" resultType="int"> 
    SELECT count(post_id)FROM blind.post_mgt
    where #{boardId} = blind.post_mgt.board_id;
</select>		 
	
<!-- 콤보박스의 정렬기준 옵션(최신순,추천순) -->
<!-- 콤보박스의 정렬기준 옵션_최신순  -->
<select id="sortPostBylatestDate" resultType="com.ksinfo.blind.search.dto.PostDto"> 
SELECT * FROM blind.post_mgt
ORDER BY post_create_date DESC;	 
</select>		 
	 
<!-- 콤보박스의 정렬기준 옵션_추천순 -->	 
<select id="sortPostByRecommendCounts" resultType="com.ksinfo.blind.search.dto.PostDto"> 
<!-- (작성중) -->
</select>		 


</mapper>

